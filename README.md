# Surebet Notifier (Telegram)

Скрипт для арбитража между букмекерскими платформами: забирает котировки через The Odds API, сопоставляет один и тот же матч у разных букмекеров и присылает сообщение в Telegram **только если найден арбитраж** (surebet). Поддерживает 2‑исходные рынки (теннис/ML) и 1X2 (футбол).

## Что присылает бот
- Матч, время начала, рынок
- Какие букмекеры и какие коэффициенты берём
- Σ(1/коэфф) и величину Edge
- Готовые доли ставок (на примерный банк из `.env` — `BANK_SAMPLE`)
- Ожидаемую гарантированную прибыль на этом банке

---

## Быстрый старт

### 1) Установить Python
Python 3.10+ (проверьте `python --version`).

### 2) Скачать проект
Распакуйте архив `surebet_notifier.zip` или склонируйте содержимое в папку.

### 3) Создать и активировать виртуальное окружение
**Windows (PowerShell):**
```powershell
python -m venv .venv
. .venv\Scripts\Activate.ps1
```
**Linux/macOS:**
```bash
python -m venv .venv
source .venv/bin/activate
```

### 4) Установить зависимости
```bash
pip install -r requirements.txt
```

### 5) Настроить переменные окружения
Скопируйте `.env.example` в `.env` и заполните:
- `TELEGRAM_BOT_TOKEN` — токен вашего бота (получить у @BotFather)
- `TELEGRAM_CHAT_ID` — ID чата/канала (бот должен быть добавлен в чат и иметь право писать)
- `ODDS_API_KEY` — ключ The Odds API (зарегистрируйтесь на https://the-odds-api.com/)

При желании отредактируйте:
- `SPORTS` — виды спорта (ключи из The Odds API)
- `MARKETS` — рынки (по умолчанию `h2h`)
- `REGIONS` — регионы провайдеров котировок
- `ARB_MIN_EDGE` — минимальный Edge (например 0.006 = 0.6%)
- `POLL_INTERVAL` — интервал опроса в секундах
- `DEDUP_MINUTES` — дедупликация одинаковых сигнало
- `BANK_SAMPLE` — банкролл, который будет использоваться в сообщениях для расчёта долей ставок

### 6) Запуск

**Windows (PowerShell):**
```powershell
# Загрузим переменные из .env в текущий процесс
Get-Content .env | foreach {
  if ($_ -and $_ -notmatch '^#') {
    $name,$value = $_.split('=',2)
    [Environment]::SetEnvironmentVariable($name,$value,"Process")
  }
}
python main.py
```

**Linux/macOS:**
```bash
export $(grep -v '^#' .env | xargs) && python main.py
```

---

## Как работает арбитражная проверка

### 2‑исходные рынки
Берутся лучшие коэффициенты на каждый исход от **разных** букмекеров. Если `1/odd1 + 1/odd2 < 1` и Edge ≥ `ARB_MIN_EDGE` — отправляется сигнал.

### 1X2 (футбол)
Подбирается тройка коэффициентов (минимум от двух разных букмекеров). Если `1/h + 1/d + 1/a < 1` и Edge ≥ `ARB_MIN_EDGE` — сигнал.

Доли ставок рассчитываются по:
```
stake_i = Bank * (1/odds_i) / Σ(1/odds_j)
```

---

## Полезные советы
- Повышайте `ARB_MIN_EDGE`, чтобы отсекать комбинации, «съедаемые» комиссией и лимитами.
- Имейте в виду задержки обновления линий, ограничения по ставкам, правила контор и ToS APIs.
- Для реальных ставок сначала протестируйте всё в «сухом режиме».

---

## Частые вопросы

**Q:** Можно ли добавить конкретные API букмекеров (Pinnacle, Betfair Exchange)?  
**A:** Да. Добавляйте дополнительные провайдеры, приводите к общему формату (home/away/draw) и объединяйте в один пул котировок.

**Q:** Можно ли мониторить спреды/тоталы?  
**A:** Да. Потребуется отдельная логика для арбитража (коридоры, линии) — шаблон можно расширить.

**Q:** Как изменить банкролл в сообщениях?  
**A:** Отредактируйте `BANK_SAMPLE` в `.env`.
